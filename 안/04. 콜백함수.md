# 04. 콜백 함수

## 콜백 함수란?

콜백함수는 간단하게 다른 함수에 매개변수로 넘겨준 함수를 말한다.
<br>
매개변수로 넘겨받은 함수는 일단 넘겨받고, 때가 되면 나중에 호출(called back)한다는 것이 콜백함수의 개념이다.

```js
let count = 0;

const callbackFunc = function () {
  console.log(count);
  if (++count > 4) clearInterval(timer);
};

const timer = setInterval(callbackFunc, 300);
```

setInterval에 전달한 첫 번째 인자인 `callbackFunc` 함수가 콜백 함수이다.
<br>
setInterval 이라고 하는 다른 코드에 첫 번째 인자로서 callbackFunc 함수를 넘겨주자 제어권을 넘겨받은
setInterval이 스스로의 판단에 따라 적잘한 시점에 이 익명 함수를 실행한다.

> 이처럼 콜백 함수는 다른코드(함수 or 메서드)에게 인자로 넘겨줌으로써 그 **제어권**도 함께 위임한 함수이다.

## 콜백 함수는 함수다!

콜백 함수로 어떤 객체의 메서드를 전달하더라도 그 메서드는 메서드가 아닌 함수로서 호출된다.

```js
const obj = {
  vals: [1, 2, 3],
  logValues: function (v, i) {
    console.log(this, v, i);
  },
};

obj.logValues(1, 2); // {vals: [1,2,3], logValues: f} 1 2

[4, 5, 6].forEach(obj.logValues);
// Window{...} 4 0
// Window{...} 5 1
// Window{...} 6 2
```

- `obj.logValues` 이름 앞에 점이 있으니 메서드로서 호출! 따라서 this는 obj를 가리키고, 인자로 넘어온 1,2가 출력됨
- forEach 함수에서는 obj.logValues가 가리키는 함수만 전달! 이 함수는 메서드로서 호출할 때가 아닌 한 obj와의
  직접적인 연관이 없어진다. forEach에 의해 콜백이 함수로서 호출되고, 별도로 this를 지정하는 인자를 지정하지 않았으므로 함수 내부
  에서의 this는 전역객체를 바라본다.

> 그래서 bind 메서드로 콜백 함수 내부에서 this가 객체를 바라보게 할 수 있다.

```js
const obj1 = {
  name: "obj1",
  func: function () {
    console.log(this.name);
  },
};
setTimeout(obj.func.bind(obj1), 1000);

const obj2 = { name: "obj2" };
setTimeout(obj1.func.bind(obj2), 1500);
```

## 콜백 지옥

비동기 호출이 자주 일어나는 프로그램의 경우 '콜백 지옥'이 발생한다.
함수의 매개변수로 넘겨지는 콜백 함수가 반복되어 코드의 들여쓰기 수준이 감당하기 힘들어질 정도로 깊어지는 현상이다.

```js
function add(x, callback) {
  const sum = x + x;
  console.log(sum);
  callback(sum);
}

add(2, function (result) {
  add(result, function (result) {
    add(result, function (result) {
      console.log("finish!!");
    });
  });
});
```

> 해결 방안: Promise, Generator, async/await 등 이용하여 사용할 수 있다!!!

비동기는 다음에...
